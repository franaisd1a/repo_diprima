clear all;
close all;
% clc;

%% Compute difference beetween MaxIm, Astrometry and egeos

%% MaxIm DL

%dimensione [6XN] h,m,s , d,m,s

dataMaxImDMS=[
              22,11, 4.6 , -1,48,04.1;%7914
              22,24,52.45, -1,39,24.6;%7917
              22,26,52.96, -1,38,15.0;%7918
%               22,28,52.54, -1,37,05.4;%7919
              22,30,53.12, -1,35,58.4;%7920
              22,36,54.18, -1,32,42.3;%7923
              22,38,54.48, -1,31,38.4;%7924
              22,40,56.30, -1,30,37.9;%7925
              22,44,55.68, -1,28,39.5;%7927
              22,46,55.84, -1,27,42.6;%7928
              22,48,56.79, -1,26,47.4;%7929
              22,50,57.56, -1,25,49.9;%7930
              22,52,57.44, -1,24,58.4;%7931
              22,54,57.59, -1,24,06.8;%7932
              22,56,58.60, -1,23,14.7;%7933
              22,58,58.78, -1,22,24.6;%7934
              23,00,59.22, -1,21,36.9;%7935
              23,02,59.76, -1,20,51.3;%7936
%               23,04,59.85, -1,20,06.1;%7937
              23,07,00.90, -1,19,21.5;%7938
              23,09,01.18, -1,18,38.9;%7939
              23,11,02.44, -1,17,57.5; %7940
%               23,13,02.53, -1,17,18.4; %7941
              23,15,03.16, -1,16,39.7; %7942
              23,17, 3.75, -1,16, 5.6;%7943
              23,19, 4.06, -1,15,27.2;%7944
%               23,21, 4.04, -1,14,55.1;%7945
%               23,23, 5.48, -1,14,21.7;%7946
%               23,27, 6.52, -1,13,18.7;%7948              
              23,29, 7.07, -1,12,50.2;%7949              
%               23,31, 7.22, -1,12,24.1;%7950
              23,33, 8.16, -1,11,57.7;%7951
              23,35, 8.74, -1,11,32.8;%7952
%               23,37, 9.59, -1,11, 9.4;%7953
              23,39, 9.49, -1,10,50.1;%7954
%               23,41,10.21, -1,10,29.7;%7955
               1,29,51.28, -1,27,24.9;%8009
               1,31,51.63, -1,28,22.6;%8010
%                1,33,52.48, -1,29,20.4;%8011
               1,35,53.26, -1,30,22.0;%8012
               1,37,54.15, -1,31,22.2;%8013
               1,39,54.72, -1,32,25.2;%8014
%                1,43,56.63, -1,34,32.9 %8016
                                      ];
                                  
% dataMaxImDMS=[23,17, 3.75, -1,16, 5.6;%7943
%               23,19, 4.06, -1,15,27.2;%7944
%               23,21, 4.38, -1,14,53.2;%7945
%               23,23, 5.46, -1,14,19.7;%7946
%               23,27, 6.52, -1,13,18.7;%7948              
%               23,29, 7.07, -1,12,50.2;%7949              
%               23,31, 7.22, -1,12,24.1;%7950
%               23,33, 8.16, -1,11,57.7;%7951
%               23,35, 8.74, -1,11,32.8;%7952
%               23,37, 9.41, -1,11,10.4;%7953
%               23,39, 9.49, -1,10,50.1;%7954
%               23,41,10.21, -1,10,29.7;%7955
%                1,29,51.28, -1,27,24.9;%8009
%                1,31,51.50, -1,28,22.9;%8010
%                1,33,52.48, -1,29,20.4;%8011
%                1,35,53.26, -1,30,22.0;%8012
%                1,37,54.15, -1,31,22.2;%8013
%                1,39,54.72, -1,32,25.2;%8014
%                1,43,56.63, -1,34,34.9 %8016
%                                       ];
                                  
dataMaxImSec=zeros(length(dataMaxImDMS(:,1)),2);

%% Astrometry

%Pixel float
%dimensione [2XN] deg, deg
dataAstroDeg=[  332.769254089728406,-1.801206402444200;%7914
                336.218842183547679,-1.656958640928549;%7917
                336.720890289755403,-1.637632299234394;%7918
%                 337.219520181995108,-1.618228459890531;%7919
                337.721577567189286,-1.599590096037760;%7920
                339.225856550041101,-1.544994310423252;%7923
                339.727251666263271,-1.527300528793254;%7924
                340.234883393228927,-1.510698346101043;%7925
                341.232125329239466,-1.477840127610850;%7927
                341.733009919564211,-1.461932734657386;%7928
                342.236969524473864,-1.446442700144664;%7929
                342.740065703222058,-1.430632582570629;%7930
                343.239711040806924,-1.416166835913909;%7931
                343.740119820086022,-1.402032469822967;%7932
                344.244456360556057,-1.387559988105904;%7933
                344.745065951664742,-1.373656684513102;%7934
                345.246974501525756,-1.360427505123689;%7935
                345.749152152859438,-1.347828969265163;%7936
%                 346.250089336996837,-1.335076021245437;%7937
                346.753904487627551,-1.322603974386994;%7938
                347.254819080804623,-1.310813300780205;%7939
                347.760240842611836,-1.299569059751867; %7940
%                 348.260959037675320,-1.288468214436961; %7941
                348.763339712894663,-1.277744149086316; %7942
                349.265930008633973,-1.268151087396256; %7943
                349.766999234097398,-1.257474260987555; %7944
%                 350.268517982254764,-1.247916796711323; %7945
%                 350.772874482373140,-1.238726162816886; %7946
%                 351.776948871628974,-1.222149843225945; %7948
                352.279662373575036,-1.214083960596502; %7949
%                 352.780306181599030,-1.206972302337753; %7950
                353.284138157406801,-1.199387814084484; %7951
                353.786626247251775,-1.192570815715803; %7952
%                 354.289428461652733,-1.186358856037345; %7953
                354.789867978119901,-1.180601451420621; %7954
%                 355.292800443658564,-1.174366924953338; %7955
                 22.463963245344043,-1.457047147182631; %8009
                 22.964762204180591,-1.473160237299896; %8010
%                  23.469144342281712,-1.489170290465748; %8011
                 23.972034105897777,-1.506034779394618; %8012
                 24.475773367875597,-1.523062382808014; %8013
                 24.978344188174379,-1.540501118733950; %8014
%                  25.985866459826937,-1.576412458394030; %8016
                                    ];
       
%Pixel interi
% dataAstroDeg=[  349.265533,-1.268734; %7943
%                 349.766663,-1.258072; %7944
%                 350.268188,-1.248546; %7945
%                 350.772461,-1.239341; %7946
%                 351.776581,-1.222779; %7948
%                 352.279144,-1.214707; %7949
%                 352.779968,-1.207602; %7950
%                 353.283722,-1.200017; %7951
%                 353.786102,-1.193200; %7952
%                 354.289063,-1.186989; %7953
%                 354.789429,-1.181218; %7954
%                 355.292358,-1.174996; %7955
%                  22.463577,-1.457620; %8009
%                  22.964506,-1.473768; %8010
%                  23.468840,-1.489787; %8011
%                  23.971666,-1.506665; %8012
%                  24.475540,-1.523674; %8013
%                  24.977966,-1.541070; %8014
%                  25.985613,-1.577043; %8016
%                                     ];                                

%Pixel interi senza correzione distorsione sensore
% dataAstroDeg=[  349.265594,-1.268655; %7943
%                 349.766571,-1.257732; %7944
%                 350.268158,-1.248541; %7945
%                 350.772430,-1.239322; %7946
%                 351.776367,-1.222815; %7948
%                 352.279083,-1.214676; %7949
%                 352.779388,-1.207588; %7950
%                 353.283691,-1.199989; %7951
%                 353.786041,-1.193199; %7952
%                 354.288971,-1.186931; %7953
%                 354.789429,-1.181223; %7954
%                 355.292358,-1.174998; %7955
%                  22.463606,-1.457599; %8009
%                  22.964502,-1.473687; %8010
%                  23.468674,-1.489836; %8011
%                  23.971600,-1.506639; %8012
%                  24.475122,-1.523762; %8013
%                  24.977949,-1.541117; %8014
%                  25.985224,-1.576961; %8016
%                                     ];     
                                
dataAstroDMS=zeros(length(dataAstroDeg(:,1)),6);
dataAstroSec=zeros(length(dataAstroDeg(:,1)),2);

%% Egeos

egeosSecDMS=[ 
23,	17,	3.44  ,   -	1,	16,	2.9  ;  %7943
23,	19,	3.31  ,   -	1,	15,	24.6 ;  %7944 
% 23,	21,	4.11  ,   -	1,	14,	50.9 ;  %7945 
% 23,	23,	4.92	, -	1,	14,	20.8 ;  %7946 
23,	27,	6.19  ,   -	1,	13,	19.4 ;  %7948 
23,	29,	6.87  ,   -	1,	12,	50.9 ;  %7949 
23,	31,	6.91  ,   -	1,	12,	26.8 ;  %7950 
23,	33,	7.57  ,   -	1,	11,	56.9 ;  %7951 
23,	35,	8.65  ,   -	1,	11,	31.9 ;  %7952 
23,	37,	8.9   ,   -	1,	11,	10.1 ;  %7953 
23,	39,	9.39  ,   -	1,	10,	48.3 ;  %7954 
% 23,	41,	9.95  ,   -	1,	10,	26   ;  %7955 
 0,    0,   0   ,     0,   0, 0    ;  %8009 
 1,	31,	51.19,	-	1,	28,	21.8 ;  %8010 
 1,	33,	52.17 ,  -	1,	29,	23.8 ;  %8011 
 1,	35,	52.89 ,  -	1,	30,	22.8 ;  %8012 
 1,	37,	53.64 ,  -	1,	31,	25.9 ;  %8013 
 1,	39,	54.36 ,  -	1,	32,	26.6 ;  %8014 
%  1,	43,	56.06 ,  -	1,	34,	31.8    %8016 
];

dataEgeosSec=zeros(length(dataMaxImDMS(:,1)),2);

%% Computations

if(length(dataAstroDeg(:,1))~=length(dataMaxImDMS(:,1)))
    minCnt=min(length(dataAstroDeg(:,1)),length(dataMaxImDMS(:,1)));
    cnt=minCnt;
    disp('Errore ciao');
    %     break;
else
    cnt=length(dataMaxImDMS(:,1));
end

diffMA=zeros(cnt,2);
diffME=zeros(cnt,2);
diffAE=zeros(cnt,2);

for i=1:cnt
%     [dataAstroDMS(i,1:3),dataAstroDMS(i,4:6)]=radecDeg2hgMS( dataAstroDeg(i,1),dataAstroDeg(i,2) );
    
%     dec=degrees2dms(dec_deg);
% ra=degrees2dms(ra_deg/15);
    
    dataAstroDMS(i,1:3)=degrees2dms(dataAstroDeg(i,1)/15);
    dataAstroDMS(i,4:6)=degrees2dms(dataAstroDeg(i,2));

    dataAstroSec(i,1)=dataAstroDMS(i,1)*3600+dataAstroDMS(i,2)*60+dataAstroDMS(i,3);
    dataAstroSec(i,2)=dataAstroDMS(i,4)*3600+dataAstroDMS(i,5)*60+dataAstroDMS(i,6);
    
    dataMaxImSec(i,1)=dataMaxImDMS(i,1)*3600+dataMaxImDMS(i,2)*60+dataMaxImDMS(i,3);
    dataMaxImSec(i,2)=dataMaxImDMS(i,4)*3600+dataMaxImDMS(i,5)*60+dataMaxImDMS(i,6);

    diffMA(i,1)=dataMaxImSec(i,1)-dataAstroSec(i,1);
    diffMA(i,2)=dataMaxImSec(i,2)-dataAstroSec(i,2);
    
%     dataEgeosSec(i,1)=egeosSecDMS(i,1)*3600+egeosSecDMS(i,2)*60+egeosSecDMS(i,3);
%     dataEgeosSec(i,2)=egeosSecDMS(i,4)*3600+egeosSecDMS(i,5)*60+egeosSecDMS(i,6);
%     diffME(i,1)=dataMaxImSec(i,1)-dataEgeosSec(i,1);
%     diffME(i,2)=dataMaxImSec(i,2)-dataEgeosSec(i,2);
%     
%     diffAE(i,1)=dataAstroSec(i,1)-dataEgeosSec(i,1);
%     diffAE(i,2)=dataAstroSec(i,2)-dataEgeosSec(i,2);
end
diffMA

meanMA=mean(diffMA);
stdMA=std(diffMA);
indRm=find(egeosSecDMS(:,1)==0);
diffME(indRm,:)=[];
meanME=mean(diffME);
stdME=std(diffME);
diffAE(indRm,:)=[];
meanAE=mean(diffAE);
stdAE=std(diffAE);

% diffME
% diffAE

figure(1)
subplot(1,2,1);
xbins1 = -0.2:0.1:0.15;
hist(diffMA(:,1),xbins1);
xlabel('RA difference [arcsec]','FontWeight','bold');
ylabel('Counts','FontWeight','bold');
subplot(1,2,2);
xbins2 = -2.5:0.5:2.5;
hist(diffMA(:,2),xbins2);
xlabel('DEC difference [arcsec]','FontWeight','bold');

set(gcf,'NextPlot','add');
axes;
h = title('Difference respect MaxIm DL','FontWeight','bold');
set(gca,'Visible','off');
set(h,'Visible','on');
%title('Difference respect MaxIm DL','FontWeight','bold');



