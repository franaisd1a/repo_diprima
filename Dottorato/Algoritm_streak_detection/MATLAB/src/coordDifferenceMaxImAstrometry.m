clear all;
close all;
% clc;

%% Compute difference beetween MaxIm, Astrometry and egeos

%% MaxIm DL

%dimensione [6XN] h,m,s , d,m,s

dataMaxImDMS=[23,17, 3.75, -1,16, 5.6;%7943
              23,19, 4.06, -1,15,27.2;%7944
%               23,21, 4.04, -1,14,55.1;%7945
%               23,23, 5.48, -1,14,21.7;%7946
              23,27, 6.52, -1,13,18.7;%7948              
              23,29, 7.07, -1,12,50.2;%7949              
              23,31, 7.22, -1,12,24.1;%7950
              23,33, 8.16, -1,11,57.7;%7951
              23,35, 8.74, -1,11,32.8;%7952
              23,37, 9.59, -1,11, 9.4;%7953
              23,39, 9.49, -1,10,50.1;%7954
%               23,41,10.21, -1,10,29.7;%7955
               1,29,51.28, -1,27,24.9;%8009
               1,31,51.63, -1,28,22.6;%8010
               1,33,52.48, -1,29,20.4;%8011
               1,35,53.26, -1,30,22.0;%8012
               1,37,54.15, -1,31,22.2;%8013
               1,39,54.72, -1,32,25.2;%8014
%                1,43,56.63, -1,34,32.9 %8016
                                      ];
                                  
% dataMaxImDMS=[23,17, 3.75, -1,16, 5.6;%7943
%               23,19, 4.06, -1,15,27.2;%7944
%               23,21, 4.38, -1,14,53.2;%7945
%               23,23, 5.46, -1,14,19.7;%7946
%               23,27, 6.52, -1,13,18.7;%7948              
%               23,29, 7.07, -1,12,50.2;%7949              
%               23,31, 7.22, -1,12,24.1;%7950
%               23,33, 8.16, -1,11,57.7;%7951
%               23,35, 8.74, -1,11,32.8;%7952
%               23,37, 9.41, -1,11,10.4;%7953
%               23,39, 9.49, -1,10,50.1;%7954
%               23,41,10.21, -1,10,29.7;%7955
%                1,29,51.28, -1,27,24.9;%8009
%                1,31,51.50, -1,28,22.9;%8010
%                1,33,52.48, -1,29,20.4;%8011
%                1,35,53.26, -1,30,22.0;%8012
%                1,37,54.15, -1,31,22.2;%8013
%                1,39,54.72, -1,32,25.2;%8014
%                1,43,56.63, -1,34,34.9 %8016
%                                       ];
                                  
dataMaxImSec=zeros(length(dataMaxImDMS(:,1)),2);

%% Astrometry

%Pixel float
%dimensione [2XN] deg, deg
dataAstroDeg=[  349.265930008633973,-1.268151087396256; %7943
                349.766999234097398,-1.257474260987555; %7944
%                 350.268517982254764,-1.247916796711323; %7945
%                 350.772874482373140,-1.238726162816886; %7946
                351.776948871628974,-1.222149843225945; %7948
                352.279662373575036,-1.214083960596502; %7949
                352.780306181599030,-1.206972302337753; %7950
                353.284138157406801,-1.199387814084484; %7951
                353.786626247251775,-1.192570815715803; %7952
                354.289428461652733,-1.186358856037345; %7953
                354.789867978119901,-1.180601451420621; %7954
%                 355.292800443658564,-1.174366924953338; %7955
                 22.463963245344043,-1.457047147182631; %8009
                 22.964762204180591,-1.473160237299896; %8010
                 23.469144342281712,-1.489170290465748; %8011
                 23.972034105897777,-1.506034779394618; %8012
                 24.475773367875597,-1.523062382808014; %8013
                 24.978344188174379,-1.540501118733950; %8014
%                  25.985866459826937,-1.576412458394030; %8016
                                    ];
       
%Pixel interi
% dataAstroDeg=[  349.265533,-1.268734; %7943
%                 349.766663,-1.258072; %7944
%                 350.268188,-1.248546; %7945
%                 350.772461,-1.239341; %7946
%                 351.776581,-1.222779; %7948
%                 352.279144,-1.214707; %7949
%                 352.779968,-1.207602; %7950
%                 353.283722,-1.200017; %7951
%                 353.786102,-1.193200; %7952
%                 354.289063,-1.186989; %7953
%                 354.789429,-1.181218; %7954
%                 355.292358,-1.174996; %7955
%                  22.463577,-1.457620; %8009
%                  22.964506,-1.473768; %8010
%                  23.468840,-1.489787; %8011
%                  23.971666,-1.506665; %8012
%                  24.475540,-1.523674; %8013
%                  24.977966,-1.541070; %8014
%                  25.985613,-1.577043; %8016
%                                     ];                                

%Pixel interi senza correzione distorsione sensore
% dataAstroDeg=[  349.265594,-1.268655; %7943
%                 349.766571,-1.257732; %7944
%                 350.268158,-1.248541; %7945
%                 350.772430,-1.239322; %7946
%                 351.776367,-1.222815; %7948
%                 352.279083,-1.214676; %7949
%                 352.779388,-1.207588; %7950
%                 353.283691,-1.199989; %7951
%                 353.786041,-1.193199; %7952
%                 354.288971,-1.186931; %7953
%                 354.789429,-1.181223; %7954
%                 355.292358,-1.174998; %7955
%                  22.463606,-1.457599; %8009
%                  22.964502,-1.473687; %8010
%                  23.468674,-1.489836; %8011
%                  23.971600,-1.506639; %8012
%                  24.475122,-1.523762; %8013
%                  24.977949,-1.541117; %8014
%                  25.985224,-1.576961; %8016
%                                     ];     
                                
dataAstroDMS=zeros(length(dataAstroDeg(:,1)),6);
dataAstroSec=zeros(length(dataAstroDeg(:,1)),2);

%% Egeos

egeosSecDMS=[ 
23,	17,	3.44  ,   -	1,	16,	2.9  ;  %7943
23,	19,	3.31  ,   -	1,	15,	24.6 ;  %7944 
% 23,	21,	4.11  ,   -	1,	14,	50.9 ;  %7945 
% 23,	23,	4.92	, -	1,	14,	20.8 ;  %7946 
23,	27,	6.19  ,   -	1,	13,	19.4 ;  %7948 
23,	29,	6.87  ,   -	1,	12,	50.9 ;  %7949 
23,	31,	6.91  ,   -	1,	12,	26.8 ;  %7950 
23,	33,	7.57  ,   -	1,	11,	56.9 ;  %7951 
23,	35,	8.65  ,   -	1,	11,	31.9 ;  %7952 
23,	37,	8.9   ,   -	1,	11,	10.1 ;  %7953 
23,	39,	9.39  ,   -	1,	10,	48.3 ;  %7954 
% 23,	41,	9.95  ,   -	1,	10,	26   ;  %7955 
 0,    0,   0   ,     0,   0, 0    ;  %8009 
 1,	31,	51.19,	-	1,	28,	21.8 ;  %8010 
 1,	33,	52.17 ,  -	1,	29,	23.8 ;  %8011 
 1,	35,	52.89 ,  -	1,	30,	22.8 ;  %8012 
 1,	37,	53.64 ,  -	1,	31,	25.9 ;  %8013 
 1,	39,	54.36 ,  -	1,	32,	26.6 ;  %8014 
%  1,	43,	56.06 ,  -	1,	34,	31.8    %8016 
];

dataEgeosSec=zeros(length(dataMaxImDMS(:,1)),2);

%% Computations

if(length(dataAstroDeg(:,1))~=length(dataMaxImDMS(:,1)))
    minCnt=min(length(dataAstroDeg(:,1)),length(dataMaxImDMS(:,1)));
    cnt=minCnt;
    disp('Errore ciao');
    %     break;
else
    cnt=length(dataMaxImDMS(:,1));
end

diffMA=zeros(cnt,2);
diffME=zeros(cnt,2);
diffAE=zeros(cnt,2);

for i=1:cnt
%     [dataAstroDMS(i,1:3),dataAstroDMS(i,4:6)]=radecDeg2hgMS( dataAstroDeg(i,1),dataAstroDeg(i,2) );
    
%     dec=degrees2dms(dec_deg);
% ra=degrees2dms(ra_deg/15);
    
    dataAstroDMS(i,1:3)=degrees2dms(dataAstroDeg(i,1)/15);
    dataAstroDMS(i,4:6)=degrees2dms(dataAstroDeg(i,2));

    dataAstroSec(i,1)=dataAstroDMS(i,1)*3600+dataAstroDMS(i,2)*60+dataAstroDMS(i,3);
    dataAstroSec(i,2)=dataAstroDMS(i,4)*3600+dataAstroDMS(i,5)*60+dataAstroDMS(i,6);
    
    dataMaxImSec(i,1)=dataMaxImDMS(i,1)*3600+dataMaxImDMS(i,2)*60+dataMaxImDMS(i,3);
    dataMaxImSec(i,2)=dataMaxImDMS(i,4)*3600+dataMaxImDMS(i,5)*60+dataMaxImDMS(i,6);
    
    dataEgeosSec(i,1)=egeosSecDMS(i,1)*3600+egeosSecDMS(i,2)*60+egeosSecDMS(i,3);
    dataEgeosSec(i,2)=egeosSecDMS(i,4)*3600+egeosSecDMS(i,5)*60+egeosSecDMS(i,6);
    
    diffMA(i,1)=dataMaxImSec(i,1)-dataAstroSec(i,1);
    diffMA(i,2)=dataMaxImSec(i,2)-dataAstroSec(i,2);
    
    diffME(i,1)=dataMaxImSec(i,1)-dataEgeosSec(i,1);
    diffME(i,2)=dataMaxImSec(i,2)-dataEgeosSec(i,2);
    
    diffAE(i,1)=dataAstroSec(i,1)-dataEgeosSec(i,1);
    diffAE(i,2)=dataAstroSec(i,2)-dataEgeosSec(i,2);
end
diffMA

meanMA=mean(diffMA);
diffME(13,:)=[];
meanME=mean(diffME);
diffAE(13,:)=[];
meanAE=mean(diffAE);

diffME
diffAE

figure(1)
subplot(1,2,1);
xbins1 = -0.4:0.05:0.35;
hist(diffMA(:,1),xbins1);
xlabel('RA difference [arcsec]');ylabel('Counts');
subplot(1,2,2);
xbins2 = -2.5:0.5:3;
hist(diffMA(:,2),xbins2);
xlabel('DEC difference [arcsec]');

set(gcf,'NextPlot','add');
axes;
h = title('Difference respect MaxIm DL','FontWeight','bold');
set(gca,'Visible','off');
set(h,'Visible','on');
%title('Difference respect MaxIm DL','FontWeight','bold');



